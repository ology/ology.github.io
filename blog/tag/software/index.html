<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Gene Boggs</title>
        <meta content="Statocles 0.097" name="generator">
        <link href="/blog/tag/software.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/tag/software.rss" rel="alternate" type="application/rss+xml">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">Gene Boggs</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            
        </header>
        <div class="main container">
            <div class="row">
                <div class="nine columns">
                    <main>
                        

<article>
    <header>
        <h1><a href="/blog/2020/11/23/generating-musical-phrases-round-ii/">Generating Musical Phrases - Round II</a></h1>

        <aside>
            <time datetime="2020-11-23">
                Posted on 2020-11-23
            </time>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/music/" rel="tag">music</a>
            <a href="/blog/tag/software/" rel="tag">software</a>
            <a href="/blog/tag/perl/" rel="tag">perl</a>
            <a href="/blog/tag/midi/" rel="tag">MIDI</a>
            <a href="/blog/tag/generative/" rel="tag">generative</a>
        </p>

    </header>

    <p>It seems I am always fiddling with algorithmic musical composition.  Most recently it is with the program, polygenic, which is a descendant of the program in the previous post on this subject.</p>

<p>~</p>

<p>For this program, first up is to declare our standard Perl preamble.  Then version 5.20 is required (in order to allow <a href="https://perldoc.perl.org/perlref#Postfix-Dereference-Syntax">&quot;post-deref&quot; syntax</a>), and some of my favorite music modules - well many!</p>

<p>Anyway, next the program either gets or sets defaults for its parameters.  (The &quot;getting&quot; is done via the command-line as arguments given to the program.)  For instance, the default generated composition will be in the key of A minor at 105 beats per minute.</p>

<p>A <a href="https://metacpan.org/release/MIDI-Drummer-Tiny">drummer</a> is created.  This includes a handy score object.  The beat count is initialized at zero, the 3 parts are synchronized (i.e. played simultaneously), and the score is written to a MIDI file, which is set by the drummer and named after the program.</p>

<p>Pretty simple, eh?  Haha!  (Well yes, to me, the author, it is.)</p>

<p>The meat of this program lies in the two parts called &quot;top()&quot; and &quot;bottom()&quot; - Brilliant names, yes?  They are both extremely similar, but each have entirely different repeated phrases, and are in different octaves.</p>

<p>Please see the source code if you are interested in the workings.  But here are a couple audio examples.  Both are in 5/4 (drums and bass), but the top parts are in 4/4.  Why 5/4?  Because I am fascinated with odd meters and polyrhythms.</p>

<p>In the first, the top part is made with combinations of half, quarter and eighth notes.  The second adds triplet eighth notes to the mix.  I call this &quot;solo mode.&quot;  Haha.</p>

<p><a href="/blog/2020/11/23/generating-musical-phrases-round-ii/polygenic-10-Solo-mode.mp3">polygenic-10-Solo-mode.mp3</a></p>

<p><a href="/blog/2020/11/23/generating-musical-phrases-round-ii/polygenic-10-Solo-mode-1.mp3">polygenic-10-Solo-mode-1.mp3</a></p>

<p>Ok. One more.  This has phrases with &quot;charming grace-notes&quot;, because the phrase generator produced one without proper triplets:</p>

<p><a href="/blog/2020/11/23/generating-musical-phrases-round-ii/polygenic-9-Charming-grace-notes.mp3">polygenic-9-Charming-grace-notes.mp3</a></p>

<p><strong>UPDATE:</strong></p>

<p>The <a href="https://github.com/ology/Music/blob/master/chordal">descendant program</a> that adds, what sound like chords:</p>

<p><a href="/blog/2020/11/23/generating-musical-phrases-round-ii/chordal-03.mp3">chordal-03.mp3</a></p>

<p>Here is the same descendant program, but playing every other bar a whole note on top instead of the solo notes:</p>

<p><a href="/blog/2020/11/23/generating-musical-phrases-round-ii/chordal-04.mp3">chordal-04.mp3</a></p>



</article>
<article>
    <header>
        <h1><a href="/blog/2020/11/11/generating-musical-phrases/">Generating Musical Phrases</a></h1>

        <aside>
            <time datetime="2020-11-11">
                Posted on 2020-11-11
            </time>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/music/" rel="tag">music</a>
            <a href="/blog/tag/software/" rel="tag">software</a>
            <a href="/blog/tag/perl/" rel="tag">perl</a>
            <a href="/blog/tag/midi/" rel="tag">MIDI</a>
            <a href="/blog/tag/generative/" rel="tag">generative</a>
        </p>

    </header>

    <p>After years of fiddling with algorithmic composition, I have come to reach for certain tools to craft melodies, bass-lines, solos, etc.  My latest generative composition program and output will illustrate...</p>

<p>~</p>

<p>The program in question is <a href="https://github.com/ology/Music/blob/master/quasi-random-durations">quasi-random-durations</a></p>

<p>The code libraries that I love to use so much are:</p>

<ul>
<li><a href="https://metacpan.org/release/Data-Dumper-Compact">Data::Dumper::Compact</a> - For concisely displaying the data structures that embody programmed musical things.</li>
<li><a href="https://metacpan.org/release/MIDI-Drummer-Tiny">MIDI::Drummer::Tiny</a> - For adding beats to my projects.</li>
<li><a href="https://metacpan.org/release/Music-Duration-Partition">Music::Duration::Partition</a> - For generating quasi-random rhythmic phrases in a given duration.</li>
<li><a href="https://metacpan.org/release/Music-Scales">Music::Scales</a> - For providing the scale notes that are the atoms of music.</li>
<li><a href="https://metacpan.org/release/Music-VoiceGen">Music::VoiceGen</a> - For generating a smooth series of pitches.</li>
</ul>

<p>(A couple are written by me, because they didn&#39;t exist yet!)</p>

<p>Here is the output of <a href="https://github.com/ology/Music/blob/master/quasi-random-durations">the program</a> imported into my <a href="https://www.apple.com/logic-pro/">DAW</a>, tweaked and enhanced.  The keyboards and bass were generated by selecting the &quot;better&quot; bits after many runs.  Also: it is an an odd time signature: 5/4, then 3/4, then 5/4 again.</p>

<p><a href="/blog/2020/11/11/generating-musical-phrases/Pentametric.mp3">Pentametric.mp3</a></p>



</article>
<article>
    <header>
        <h1><a href="/blog/2020/11/01/imitating-a-drum-circle/">Imitating a Drum Circle</a></h1>

        <aside>
            <time datetime="2020-11-01">
                Posted on 2020-11-01
            </time>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/music/" rel="tag">music</a>
            <a href="/blog/tag/software/" rel="tag">software</a>
            <a href="/blog/tag/perl/" rel="tag">perl</a>
            <a href="/blog/tag/midi/" rel="tag">MIDI</a>
            <a href="/blog/tag/generative/" rel="tag">generative</a>
            <a href="/blog/tag/drums/" rel="tag">drums</a>
        </p>

    </header>

    <p><img alt="" src="/blog/2020/11/01/imitating-a-drum-circle/drum-circle.jpg">
Ever been to the park and heard a tribe drumming in the distance?  This is a <a href="https://en.wikipedia.org/wiki/Drum_circle">drum circle</a>.
Upon closer inspection, each drummer has a single instrument (or maybe a set of bongos).
Each drummer keeps a steady beat in common and in syncopation with his or her fellow drummers.</p>

<p>~</p>

<p>I wondered if this could be simulated somehow?  There are of course decisions to be made - parts to this equation... How should the drummers enter? All at once or gradually?  How should a drum be chosen or selected?  And what phrase(s) should be played anyway?</p>

<p>Enter MIDI-Perl.  Here is the program: <a href="https://github.com/ology/Music/blob/master/drum-circle">drum-circle</a></p>

<p>Basically it does the following:</p>

<ol>
<li><p>Use the modules necessary to have a drummer and rhythmic phrases.</p></li>
<li><p>Define the number of drummers ($max) as a number supplied by the user (or 4 by default).</p></li>
<li><p>Define a <a href="https://metacpan.org/pod/MIDI::Drummer::Tiny">MIDI::Drummer::Tiny</a> instance ($d), which will drive everything.</p></li>
<li><p>Set the possible drums to use (@DRUMS).  In our case this is a group of toms, bongos, congas, cabasa, maracas, guiro, claves, and wood blocks.</p></li>
<li><p>Declare an array of phrases (@phrases), which is to be populated with code-references.</p></li>
<li><p>Define a 4 bar <a href="https://metacpan.org/pod/Music::Duration::Partition">Music::Duration::Partition</a> instance ($mdp), which we will use to generate rhythmic motifs for each drummer.</p></li>
<li><p>Loop from 1 to $max, appending phrases to play for each new drummer.</p></li>
<li><p>Add the phrases to the score such that they are played simultaneously.</p></li>
<li><p>Write the generated &quot;composition&quot; to disk, as a MIDI file named after the program &quot;drum-circle.&quot;</p></li>
<li><p>Define the subroutine to generate our phrases!</p></li>
</ol>

<p>This last part is shown here:</p>

<pre><code>sub phrase {
    my ($p) = @_; # Phrase number

    # Get an unseen drum to use
    my $drum = $DRUMS[int rand @DRUMS];
    while ($seen{$drum}++) {
        $drum = $DRUMS[int rand @DRUMS];
    }

    # Create a rhythmic phrase
    my $motif = $mdp-&gt;motif;

    # Either rest or play the motif
    my $phrase = sub {
        for my $n (1 .. $d-&gt;bars + 4) {
            # If we are not up yet, then rest
            if ($n &lt; ($p * 4)) {
                $d-&gt;rest($d-&gt;whole);
                next;
            }
            # Otherwise play the rhythmic phrase!
            for my $i (@$motif) {
                # Get a fluctuating velocity between f and fff
                my $vol = &#39;v&#39; . (96 + int(rand 32));
                $d-&gt;note($i, $drum, $vol);
            }
        }
    };

    return $phrase;
}
</code></pre>

<p>Here the variable $p is the number 1 to $max from our loop in step #7 above.  Next, an unseen drum is selected at random.  Then a <em>quasi-random</em> rhythmic motif is generated by <a href="https://metacpan.org/pod/Music::Duration::Partition">Music::Duration::Partition</a> as defined above.  Finally an anonymous subroutine is returned, that just decides whether to play the generated motif or rest for a whole note.</p>

<p>This resting is crucial.  Each drummer enters after 16 bars of the previous drummer having played.  So, the second drummer enters after 4 bars, the third after 8, the fourth after 12, etc.  Having everyone play at once or at random was just not a pleasant musical evolution.  So I chose to have them enter one at a time.</p>

<p>Each run of this is different.  Sometimes you get a &quot;pleasant musical evolution&quot;, but sometimes you get all toms, or just a weird clash of rhythms.  Here is one with 8 voices that is ok:</p>

<p><a href="/blog/2020/11/01/imitating-a-drum-circle/drum-circle-8v.mp3">drum-circle-8v.mp3</a></p>

<p>And how about another?</p>

<p><a href="/blog/2020/11/01/imitating-a-drum-circle/drum-circle-8v-II.mp3">drum-circle-8v-II.mp3</a></p>

<p>Ok, one more!</p>

<p><a href="/blog/2020/11/01/imitating-a-drum-circle/drum-circle-8v-III.mp3">drum-circle-8v-III.mp3</a></p>



</article>

<ul class="pager">
    <li class="prev">
            <button disabled>
                ← Older
            </button>
    </li>
    <li class="next">
            <button disabled>
                Newer →
            </button>
    </li>
</ul>




                    </main>
                </div>

                <div class="three columns sidebar">
                    
                        <nav id="tags">
        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/drums/">drums</a></li>
            <li><a href="/blog/tag/generative/">generative</a></li>
            <li><a href="/blog/tag/midi/">MIDI</a></li>
            <li><a href="/blog/tag/music/">music</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/software/">software</a></li>
        </ul>
    </nav>

                            <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/tag/software.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/tag/software.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>

                </div>
            </div>
        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>


    </body>
</html>
